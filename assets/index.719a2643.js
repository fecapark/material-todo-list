var f=Object.defineProperty;var d=Object.getOwnPropertySymbols;var m=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable;var c=(s,t,e)=>t in s?f(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,u=(s,t)=>{for(var e in t||(t={}))m.call(t,e)&&c(s,e,t[e]);if(d)for(var e of d(t))v.call(t,e)&&c(s,e,t[e]);return s};var r=(s,t,e)=>(c(s,typeof t!="symbol"?t+"":t,e),e);const P=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}};P();class y{constructor(){r(this,"events",{})}subscribe(t,e){return this.events.hasOwnProperty(t)||(this.events[t]=[]),this.events[t].push(e)}publish(t,e={}){return this.events.hasOwnProperty(t)?this.events[t].map(n=>n(e)):[]}}class w{constructor(){r(this,"preventPublish",!1);r(this,"actions");r(this,"eventManager");r(this,"state");this.actions={},this.state={},this.eventManager=new y,this.setStateProxy()}setStateProxy(){const t=(e,n,i)=>(e[n]=i,this.preventPublish||this.eventManager.publish("stateChange",this.state),!0);this.state=new Proxy({},{set:t})}setDefaultState(t,e){this.preventPublish=!0,this.state[t]=e,this.preventPublish=!1}setAction(t,e){const n=i=>{const o=e({state:u({},this.state),payload:i});return this.mergeState(o)};this.actions[t]=n}dispatch(t,e){if(!this.actions.hasOwnProperty(t))throw Error(`Invalid action type: ${t}.`);this.state=this.actions[t](e)}mergeState(t){return Object.assign(this.state,t)}getState(t){if(!this.state.hasOwnProperty(t))throw Error(`Invalid state key: ${t}.`);return this.state[t]}}const p=s=>s.startsWith("#")?s:`#${s}`,g=()=>{throw Error("Please set view action to routes.")},l=class{static setViewTo(t,e,n=document.getElementById("app")){const i=()=>{n&&(n.innerHTML=""),e()};this.INFO[t].view=i}static view(t){const e=p(t);if(!this.INFO.hasOwnProperty(e)){this.view404();return}this.INFO[e].view()}static viewWithRedirect(t){const e=p(t);window.history.pushState(null,"",`${l.ROOT_PATH}${e}`),this.view(e)}static view404(){const t=document.getElementById("app");t.innerHTML="404 Page not found."}static splitProxyPath(t){const e=new RegExp("(\\/proxy\\/\\d+)+"),n=t.match(e);return{proxy:n?n[0]:"",path:t.replace(e,"")}}static setInitialRootPath(){const{proxy:t}=this.splitProxyPath(window.location.pathname);t&&(this.ROOT_PATH=`${t}/`)}};let a=l;r(a,"ROOT_PATH",""),r(a,"INFO",{"#":{name:"home",view:g},"#signin":{name:"signin",view:g}});class b{constructor({tagName:t="div",id:e="",classNames:n=[]}={}){r(this,"store");r(this,"container");r(this,"id");r(this,"classNames");this.id=e,this.classNames=n,this.container=this.createContainer(t),this.store=new w,this.store.eventManager.subscribe("stateChange",()=>this.render())}createContainer(t){const e=document.createElement(t);return e.id=this.id,this.classNames.forEach(n=>{e.classList.add(n)}),e}render(){throw Error("You must implement render method in component instance.")}}class O extends b{constructor(){super({id:"initial-logo-container"}),this.render()}render(){this.container.innerHTML=`
      <div id="logo-text-wrapper">
        <span id="logo-text">Todo List</span>
      </div>
    `}}class L{constructor(t){r(this,"globalStore");r(this,"logined");r(this,"initialLogo");this.target=t,this.globalStore=new w,this.logined=!1,this.preRenderComponents(),this.setViews(),a.setInitialRootPath(),a.view(window.location.hash)}preRenderComponents(){this.initialLogo=new O}setViews(){a.setViewTo("#",this.renderHome.bind(this)),a.setViewTo("#signin",this.renderSignIn.bind(this))}renderHome(){if(!this.logined){a.viewWithRedirect("#signin");return}this.target.innerHTML="Welcome! logined!"}renderSignIn(){this.target.appendChild(this.initialLogo.container)}}window.onload=()=>{new L(document.querySelector("#app"))};
